`npx create-next-app@latest .`

remove not required files and folder (all things in public, styles and remove code from layout and page)

install prisma extension

`npm install prisma --save-dev`
`npx prisma init --datasource-provider sqlite --output ../generated/prisma`
`npx prisma migrate dev` (add @prisma/client package and prisma generate for types for prisma client)
add generated/prisma folder to gitignore

```
model User {
  id    Int    @id @default(autoincrement())
  name  String
  email String @unique
}
```

`npx prisma studio`

create test user

```package.json
"db:migrate": "prisma migrate dev",
"db:studio": "prisma studio"
```

```tsconfig.json
  "paths": {
    "@/*": ["./src/*"],
    "$/*": ["./*"]
  }
```

```src/lib/db.ts
import { PrismaClient } from "$/generated/prisma";

const prismaClientSingleton = () => {
  return new PrismaClient();
};

declare const globalThis: {
  prismaGlobal: ReturnType<typeof prismaClientSingleton>;
} & typeof global;

const db = globalThis.prismaGlobal ?? prismaClientSingleton();

export default db;

if (process.env.NODE_ENV !== "production") globalThis.prismaGlobal = db;

```

```page.tsx

import db from "@/lib/db";

export default async function Home() {
  const user = await db.user.findFirst();
  return <>{JSON.stringify(user)}</>;
}

```

show result

implement full prisma schema
prefer to create a chart for relations

```
model Food {
  id            Int      @id @default(autoincrement())
  name          String   @unique
  calories      Float?
  protein       Float?
  fat           Float?
  carbohydrates Float?
  fiber         Float?
  sugar         Float?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

```

```
model Category {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  foods     Food[]
  createdAt  DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

show user autogenerated relations

```
model ServingUnit {
  id        Int      @id @default(autoincrement())
  name      String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
```

```

model FoodServingUnit {
  id            Int         @id @default(autoincrement())
  food          Food        @relation(fields: [foodId], references: [id])
  servingUnit   ServingUnit @relation(fields: [servingUnitId], references: [id])
  grams         Float?
  foodId        Int
  servingUnitId Int
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}


```

```

model Meal {
  id        Int      @id @default(autoincrement())
  dateTime  DateTime
  foods     Food[]
  user      User    @relation(fields: [userId], references: [id])
  userId    Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

```

```

model MealFood {
  id            Int         @id @default(autoincrement())
  food          Food        @relation(fields: [foodId], references: [id])
  meal          Meal        @relation(fields: [mealId], references: [id])
  foodId        Int
  mealId        Int
  amount        Float
  servingUnit   ServingUnit @relation(fields: [servingUnitId], references: [id])
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
  servingUnitId Int
}

```

make generated fields camelCase and make them plural and order better

```

model User {
  id        Int      @id @default(autoincrement())
  name      String
  email     String   @unique
  password  String
  role      Role     @default(USER)
  meals     Meal[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum Role {
  USER
  ADMIN
}
```

`npm run db:migrate`
it won't let us

`npx prisma db push --force-reset`

continue: create category then serving unit the foods
